<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WinNet: detailed_balance Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="winnet_logo.png"/></td>
<!--
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WinNet
-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacedetailed__balance.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">detailed_balance Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module that deals with inverse reaction rates.  
<a href="namespacedetailed__balance.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a950b42c1476c5e9a7aac95d656b3d4b1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a950b42c1476c5e9a7aac95d656b3d4b1">init_inverse_rates</a> ()</td></tr>
<tr class="memdesc:a950b42c1476c5e9a7aac95d656b3d4b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize everything for the inverse rates.  <a href="namespacedetailed__balance.html#a950b42c1476c5e9a7aac95d656b3d4b1">More...</a><br /></td></tr>
<tr class="separator:a950b42c1476c5e9a7aac95d656b3d4b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3365fc235470affbb8cde40f0252bb09"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a3365fc235470affbb8cde40f0252bb09">merge_inverse_rates</a> (rrate_array, rrate_length)</td></tr>
<tr class="memdesc:a3365fc235470affbb8cde40f0252bb09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete and create new inverse rates.  <a href="namespacedetailed__balance.html#a3365fc235470affbb8cde40f0252bb09">More...</a><br /></td></tr>
<tr class="separator:a3365fc235470affbb8cde40f0252bb09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6163da72c848a1fd418b8a1869a4dc1b"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a6163da72c848a1fd418b8a1869a4dc1b">create_inverse_rate</a> (forward_rate, inverse_rate)</td></tr>
<tr class="memdesc:a6163da72c848a1fd418b8a1869a4dc1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to create an inverse rate, based on the forward rate.  <a href="namespacedetailed__balance.html#a6163da72c848a1fd418b8a1869a4dc1b">More...</a><br /></td></tr>
<tr class="separator:a6163da72c848a1fd418b8a1869a4dc1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2ebb1580b34cd40aca41258ba5c8b7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a4c2ebb1580b34cd40aca41258ba5c8b7">calculate_detailed_balance</a> (temp, rrate_array, inverse_rate, rate)</td></tr>
<tr class="memdesc:a4c2ebb1580b34cd40aca41258ba5c8b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the inverse rate from the forward one via detailed balance.  <a href="namespacedetailed__balance.html#a4c2ebb1580b34cd40aca41258ba5c8b7">More...</a><br /></td></tr>
<tr class="separator:a4c2ebb1580b34cd40aca41258ba5c8b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5d55a056d18ca2d155d82c63e6acf48"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#ae5d55a056d18ca2d155d82c63e6acf48">write_reac_rate</a> (rate_array, nrea, rate_array_old, nrea_old)</td></tr>
<tr class="memdesc:ae5d55a056d18ca2d155d82c63e6acf48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verbose routine to output one inverse reaction of chapter 4-9.  <a href="namespacedetailed__balance.html#ae5d55a056d18ca2d155d82c63e6acf48">More...</a><br /></td></tr>
<tr class="separator:ae5d55a056d18ca2d155d82c63e6acf48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c5618f65b75159844f8c01641995cfd"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a9c5618f65b75159844f8c01641995cfd">write_reac_verbose_out</a> ()</td></tr>
<tr class="memdesc:a9c5618f65b75159844f8c01641995cfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the verbose output of the reaction rates.  <a href="namespacedetailed__balance.html#a9c5618f65b75159844f8c01641995cfd">More...</a><br /></td></tr>
<tr class="separator:a9c5618f65b75159844f8c01641995cfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad2338706cf92e52d4e474d7906f48c6c"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#ad2338706cf92e52d4e474d7906f48c6c">ninv</a></td></tr>
<tr class="memdesc:ad2338706cf92e52d4e474d7906f48c6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of inverse rates.  <a href="namespacedetailed__balance.html#ad2338706cf92e52d4e474d7906f48c6c">More...</a><br /></td></tr>
<tr class="separator:ad2338706cf92e52d4e474d7906f48c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86bdc4751e8e1e5dfe0be6da31f94424"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a86bdc4751e8e1e5dfe0be6da31f94424">ninv_old</a></td></tr>
<tr class="memdesc:a86bdc4751e8e1e5dfe0be6da31f94424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of old inverse rates.  <a href="namespacedetailed__balance.html#a86bdc4751e8e1e5dfe0be6da31f94424">More...</a><br /></td></tr>
<tr class="separator:a86bdc4751e8e1e5dfe0be6da31f94424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08fc2b98834689df08a848b70931293d"><td class="memItemLeft" align="right" valign="top">character(len=4), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a08fc2b98834689df08a848b70931293d">src_ignore</a></td></tr>
<tr class="separator:a08fc2b98834689df08a848b70931293d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acba78fea82b136053ab51e24cee093ee"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#acba78fea82b136053ab51e24cee093ee">src_ignore_length</a></td></tr>
<tr class="separator:acba78fea82b136053ab51e24cee093ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb6716dd0065b4514fd34f43e4127b49"><td class="memItemLeft" align="right" valign="top">character(len=4), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#aeb6716dd0065b4514fd34f43e4127b49">src_q_reacl</a></td></tr>
<tr class="separator:aeb6716dd0065b4514fd34f43e4127b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4253aa90ab287e76ba66938d86ac318a"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a4253aa90ab287e76ba66938d86ac318a">src_q_reacl_length</a></td></tr>
<tr class="separator:a4253aa90ab287e76ba66938d86ac318a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47aed0718562287037896aac2b22f7cb"><td class="memItemLeft" align="right" valign="top">character(len=4), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a47aed0718562287037896aac2b22f7cb">src_q_winvn</a></td></tr>
<tr class="separator:a47aed0718562287037896aac2b22f7cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b9982a2d1345f6f65ab9e908ae5a1d"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#ab8b9982a2d1345f6f65ab9e908ae5a1d">src_q_winvn_length</a></td></tr>
<tr class="separator:ab8b9982a2d1345f6f65ab9e908ae5a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5f46921ff34540b9ff17e1fac5000f9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#ac5f46921ff34540b9ff17e1fac5000f9">checklist</a></td></tr>
<tr class="separator:ac5f46921ff34540b9ff17e1fac5000f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a176c75419b4f73c949b4eaeb5bed7afe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a176c75419b4f73c949b4eaeb5bed7afe">program</a></td></tr>
<tr class="separator:a176c75419b4f73c949b4eaeb5bed7afe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0f26c3888a33692bfa29b5c8407ac1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a3e0f26c3888a33692bfa29b5c8407ac1">testdir</a></td></tr>
<tr class="separator:a3e0f26c3888a33692bfa29b5c8407ac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c3f6b6f3d9e76a83b53d567529f105"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a28c3f6b6f3d9e76a83b53d567529f105">logfile</a></td></tr>
<tr class="separator:a28c3f6b6f3d9e76a83b53d567529f105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e43f0ee3a95d79362cd3777b1a4e9e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedetailed__balance.html#a8e43f0ee3a95d79362cd3777b1a4e9e7">arcfile</a></td></tr>
<tr class="separator:a8e43f0ee3a95d79362cd3777b1a4e9e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module that deals with inverse reaction rates. </p>
<p>This module is only used when <a class="el" href="namespaceparameter__class.html#ab9087785779a37d5933cd6bb95aac997">parameter_class::use_detailed_balance</a> is enabled. The detailed balance is calculated as follows:</p>
<p class="formulaDsp">
\[ \sigma_\mathrm{inv} = N_A^{-n} \delta \left(\frac{\prod_i A_i}{\prod_j A_j}\right)^{1.5} \left(\frac{\prod_i g_i}{\prod_j g_j}\right) \left( \frac{m_u k_B T}{2\pi \hbar^2}\right)^{1.5 \cdot n} e^{-Q/(k_B T)} \sigma_\mathrm{forw}, \]
</p>
<p> where \(n\) is the number of reactants minus the number of products, \( N_A \) is Avogadros number, \(A_i\) is the mass number of reactants of the forward reaction, \(A_j\) the number of products of the forward reaction, \(g_i\) the spin factor \( 2J_i +1\) of reactants (j, for products), Q the q-value of the forward reaction, T the temperature and \( \sigma_\mathrm{forw} \) the forward reaction.</p>
<p>The necessity of calculating detailed balance within the network is given by the tabulated rates that may not easily obey the detailed balance principle otherwise. Furthermore, there exist inconsistencies between the reaclib Q-value and the Q-value calculated by the winvn (version downloaded 24.07.22). The Q-value given in the reaclib are mostly used for calculating the inverse rates. However there seem to exist also some other inconsistencies. An example of an inconsistent q-value in reaclib is given by the reaction: n + k55 -&gt; k56 other inconsistencies are included in, e.g., n + ge89 -&gt; ge90 or p + co52 -&gt; ni53 which deviates by a (almost) constant factor of 4 indicating a different spin that was used in reaclib to calculate the inverse reaction. </p><div class="image">
<img src="k56.png" alt="" height="280"/>
<div class="caption">
Reaction calculated with detailed balance and taken from reaclib (25.07.22)</div></div>
 <div class="image">
<img src="ni53.png" alt="" height="280"/>
<div class="caption">
Reaction calculated with detailed balance and taken from reaclib (25.07.22)</div></div>
<p> This problem was also topic of <a href="https://ui.adsabs.harvard.edu/abs/2017ApJS..233...18L/abstract">Lippuner &amp; Roberts 2017</a>.</p>
<p>The essence of a discussion with H. Schatz is that reaclib reactions can be based on other mass models/data than the winvn table. Every reaclib reaction can have its own set of mass tables. It might be better to calculate inverse reaction yourself in the network as you will be more consistent, especially close to equilibrium values such as NSE. However, this goes to the cost of an inconsistency between the inverse and forward rate as the forward rate involves other mass models for the calculation. For (n,gamma) reactions that are based on Hauser-Feshbach, Hendrik suggested that one could use a scaling relation of the forward rate based on the Q-value differences.</p>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22.07.22 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a4c2ebb1580b34cd40aca41258ba5c8b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c2ebb1580b34cd40aca41258ba5c8b7">&#9670;&nbsp;</a></span>calculate_detailed_balance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public detailed_balance::calculate_detailed_balance </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__class_1_1reactionrate__type.html">reactionrate_type</a>), dimension(nreac), intent(in)&#160;</td>
          <td class="paramname"><em>rrate_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__class_1_1reactionrate__type.html">reactionrate_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>inverse_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(out)&#160;</td>
          <td class="paramname"><em>rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the inverse rate from the forward one via detailed balance. </p>
<p>This subroutine calculates the inverse rate via detailed balance. Detailed balance gives a direct relation between forward and inverse reaction.</p>
<dl class="section note"><dt>Note</dt><dd>This subroutine also sets a threshold for inverse rates in case the Q-value for a photodissociation is positive. In this case the rates can diverge towards lower temperatures. This can mess up convergence of the system due to precision errors. For the default FRDM winvn/reaclib q-values this is not a problem, however, when using other mass models or when varying the masses it can become a problem.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://www.annualreviews.org/doi/10.1146/annurev.aa.05.090167.002521">Fowler, Caughlan, and Zimmerman (1967)</a> </dd></dl>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22.07.22</dd></dl>
<p><b>Edited:</b> </p><ul>
<li>18.11.22; M.R: implemented more restrictive cutoff for the rates in case of positive q-values</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rrate_array</td><td>Large rate array, containing all reactions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inverse_rate</td><td>inverse reaction rate to evaluate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">temp</td><td>Temperature [GK] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rate</td><td>Value for the reaction rate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00449">449</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacedetailed__balance_a4c2ebb1580b34cd40aca41258ba5c8b7_cgraph.svg" width="575" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a6163da72c848a1fd418b8a1869a4dc1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6163da72c848a1fd418b8a1869a4dc1b">&#9670;&nbsp;</a></span>create_inverse_rate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private detailed_balance::create_inverse_rate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structglobal__class_1_1reactionrate__type.html">reactionrate_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>forward_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__class_1_1reactionrate__type.html">reactionrate_type</a>), intent(out)&#160;</td>
          <td class="paramname"><em>inverse_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Routine to create an inverse rate, based on the forward rate. </p>
<p>Writes the correct nuclei in the parts array of each reaction. Furthermore, as the param() array of the rates is not used, it is redefined to contain:</p><ul>
<li>1: Index to forward rate in rate array</li>
<li>2: #Products - #Reactants.</li>
<li>3: \( 1.5 \cdot \log(A_{r1} \cdot ...) / (A_{p1} \cdot ...) \), with A_r being the mass number of the reactants and A_p of the products.</li>
<li>4: \( 1.5 \cdot \log(M_u/(2.0\cdot \pi \cdot \hbar^2)) \).</li>
<li>5: \( - \log((2J_{r1}+1) \cdot ...) / ((2J_{p1}+1) \cdot ...) \), with J_r being the spin of the reactants and J_p of the products. . Additionally, the Q-value is calculated from the mass excess.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22.07.22 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">forward_rate</td><td>Temporary reaction rate </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">inverse_rate</td><td>Temporary reaction rate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00323">323</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacedetailed__balance_a6163da72c848a1fd418b8a1869a4dc1b_cgraph.svg" width="100%" height="476"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a950b42c1476c5e9a7aac95d656b3d4b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a950b42c1476c5e9a7aac95d656b3d4b1">&#9670;&nbsp;</a></span>init_inverse_rates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public detailed_balance::init_inverse_rates</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize everything for the inverse rates. </p>
<p>This subroutine analyzes the parameters to determine which rates have to be replaced and which Q-value has to be used.</p>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>04.08.22 </dd></dl>

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00094">94</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacedetailed__balance_a950b42c1476c5e9a7aac95d656b3d4b1_cgraph.svg" width="356" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3365fc235470affbb8cde40f0252bb09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3365fc235470affbb8cde40f0252bb09">&#9670;&nbsp;</a></span>merge_inverse_rates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public detailed_balance::merge_inverse_rates </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structglobal__class_1_1reactionrate__type.html">reactionrate_type</a>), dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>rrate_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>rrate_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete and create new inverse rates. </p>
<p>This routine first identifies included reverse rates and deletes them. Afterwards, new reverse rates are created and attached to the rate array at the end. The position of the rates at the end of the array is important as they will use the previously calculated forward rates. Weak reactions, fission, and chapter 7 reactions do not have any inverse reaction. This routine also stores the index of the forward reaction in param(1).</p>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22.07.22 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rrate_array</td><td>Large rate array, containing all reactions </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rrate_length</td><td>length of rrate_array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00136">136</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacedetailed__balance_a3365fc235470affbb8cde40f0252bb09_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ae5d55a056d18ca2d155d82c63e6acf48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5d55a056d18ca2d155d82c63e6acf48">&#9670;&nbsp;</a></span>write_reac_rate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private detailed_balance::write_reac_rate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structglobal__class_1_1reactionrate__type.html">reactionrate_type</a>), dimension(nrea), intent(inout)&#160;</td>
          <td class="paramname"><em>rate_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nrea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structglobal__class_1_1reactionrate__type.html">reactionrate_type</a>), dimension(nrea), intent(inout)&#160;</td>
          <td class="paramname"><em>rate_array_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nrea_old</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Verbose routine to output one inverse reaction of chapter 4-9. </p>
<p>This subroutine outputs one forward, one calculated inverse, and the same inverse as given by the reaclib for chapter 4-9. All other chapters do not have forward rates so far. The calculated inverse and reaclib inverse should to large extends agree. There might be a small deviation due to different q-values used in the reaclib and in the winvn. This routine is only called when verbose_level is greater or equal two.</p>
<dl class="section note"><dt>Note</dt><dd>For all chapter 7 reactions, the double counting factor seems to be missing in the inverse rate of Reaclib (31.7.2022).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>30.07.22 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nrea_old</td><td>Length of rate arrays </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rate_array</td><td>Reaction rates with db </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rate_array_old</td><td>Reaction rates from reacl. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00559">559</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacedetailed__balance_ae5d55a056d18ca2d155d82c63e6acf48_cgraph.svg" width="100%" height="569"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a9c5618f65b75159844f8c01641995cfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c5618f65b75159844f8c01641995cfd">&#9670;&nbsp;</a></span>write_reac_verbose_out()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private detailed_balance::write_reac_verbose_out</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write the verbose output of the reaction rates. </p>
<p>The rates are always counted, for a certain verbose level they are also printed to the OUT file</p>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>21.07.22 </dd></dl>

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00902">902</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacedetailed__balance_a9c5618f65b75159844f8c01641995cfd_cgraph.svg" width="564" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8e43f0ee3a95d79362cd3777b1a4e9e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e43f0ee3a95d79362cd3777b1a4e9e7">&#9670;&nbsp;</a></span>arcfile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detailed_balance.arcfile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8py_source.html#l00009">9</a> of file <a class="el" href="detailed__balance_8py_source.html">detailed_balance.py</a>.</p>

</div>
</div>
<a id="ac5f46921ff34540b9ff17e1fac5000f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5f46921ff34540b9ff17e1fac5000f9">&#9670;&nbsp;</a></span>checklist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detailed_balance.checklist</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8py_source.html#l00003">3</a> of file <a class="el" href="detailed__balance_8py_source.html">detailed_balance.py</a>.</p>

</div>
</div>
<a id="a28c3f6b6f3d9e76a83b53d567529f105"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c3f6b6f3d9e76a83b53d567529f105">&#9670;&nbsp;</a></span>logfile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detailed_balance.logfile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8py_source.html#l00008">8</a> of file <a class="el" href="detailed__balance_8py_source.html">detailed_balance.py</a>.</p>

</div>
</div>
<a id="ad2338706cf92e52d4e474d7906f48c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2338706cf92e52d4e474d7906f48c6c">&#9670;&nbsp;</a></span>ninv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private detailed_balance::ninv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of inverse rates. </p>

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00063">63</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>

</div>
</div>
<a id="a86bdc4751e8e1e5dfe0be6da31f94424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86bdc4751e8e1e5dfe0be6da31f94424">&#9670;&nbsp;</a></span>ninv_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private detailed_balance::ninv_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of old inverse rates. </p>

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00064">64</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>

</div>
</div>
<a id="a176c75419b4f73c949b4eaeb5bed7afe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a176c75419b4f73c949b4eaeb5bed7afe">&#9670;&nbsp;</a></span>program</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detailed_balance.program</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8py_source.html#l00006">6</a> of file <a class="el" href="detailed__balance_8py_source.html">detailed_balance.py</a>.</p>

</div>
</div>
<a id="a08fc2b98834689df08a848b70931293d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08fc2b98834689df08a848b70931293d">&#9670;&nbsp;</a></span>src_ignore</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=4), dimension(:), allocatable, private detailed_balance::src_ignore</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00067">67</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>

</div>
</div>
<a id="acba78fea82b136053ab51e24cee093ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acba78fea82b136053ab51e24cee093ee">&#9670;&nbsp;</a></span>src_ignore_length</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private detailed_balance::src_ignore_length</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00068">68</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>

</div>
</div>
<a id="aeb6716dd0065b4514fd34f43e4127b49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb6716dd0065b4514fd34f43e4127b49">&#9670;&nbsp;</a></span>src_q_reacl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=4), dimension(:), allocatable, private detailed_balance::src_q_reacl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00069">69</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>

</div>
</div>
<a id="a4253aa90ab287e76ba66938d86ac318a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4253aa90ab287e76ba66938d86ac318a">&#9670;&nbsp;</a></span>src_q_reacl_length</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private detailed_balance::src_q_reacl_length</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00070">70</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>

</div>
</div>
<a id="a47aed0718562287037896aac2b22f7cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47aed0718562287037896aac2b22f7cb">&#9670;&nbsp;</a></span>src_q_winvn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=4), dimension(:), allocatable, private detailed_balance::src_q_winvn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00071">71</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>

</div>
</div>
<a id="ab8b9982a2d1345f6f65ab9e908ae5a1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b9982a2d1345f6f65ab9e908ae5a1d">&#9670;&nbsp;</a></span>src_q_winvn_length</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private detailed_balance::src_q_winvn_length</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8f90_source.html#l00072">72</a> of file <a class="el" href="detailed__balance_8f90_source.html">detailed_balance.f90</a>.</p>

</div>
</div>
<a id="a3e0f26c3888a33692bfa29b5c8407ac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e0f26c3888a33692bfa29b5c8407ac1">&#9670;&nbsp;</a></span>testdir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detailed_balance.testdir</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detailed__balance_8py_source.html#l00007">7</a> of file <a class="el" href="detailed__balance_8py_source.html">detailed_balance.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedetailed__balance.html">detailed_balance</a></li>
  </ul>
</div>
</body>
</html>
