<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WinNet: winnse_module Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="winnet_logo.png"/></td>
<!--
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WinNet
-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacewinnse__module.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">winnse_module Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module to calculate NSE.  
<a href="namespacewinnse__module.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ae51f5347267d3b4c302aebc38f248a23"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#ae51f5347267d3b4c302aebc38f248a23">nse_init</a> ()</td></tr>
<tr class="memdesc:ae51f5347267d3b4c302aebc38f248a23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates and initialises various arrays needed for the nse calculation.  <a href="namespacewinnse__module.html#ae51f5347267d3b4c302aebc38f248a23">More...</a><br /></td></tr>
<tr class="separator:ae51f5347267d3b4c302aebc38f248a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c116c4da1815117e3dd1ae3ad23fcb1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a6c116c4da1815117e3dd1ae3ad23fcb1">winnse_guess</a> (t9, rho, ye, yn_guess, yp_guess, ysol)</td></tr>
<tr class="memdesc:a6c116c4da1815117e3dd1ae3ad23fcb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate NSE composition with an initial guess.  <a href="namespacewinnse__module.html#a6c116c4da1815117e3dd1ae3ad23fcb1">More...</a><br /></td></tr>
<tr class="separator:a6c116c4da1815117e3dd1ae3ad23fcb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52f86665c1e1c3a34ef53095bf471308"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a52f86665c1e1c3a34ef53095bf471308">winnse_descend</a> (t9strt, t9fnl, rho, ye, yni, ypi, ysol)</td></tr>
<tr class="memdesc:a52f86665c1e1c3a34ef53095bf471308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This routine descends from an initially high temperature, at which the NSE abudances can be accurately predicted, to the desired temperature.  <a href="namespacewinnse__module.html#a52f86665c1e1c3a34ef53095bf471308">More...</a><br /></td></tr>
<tr class="separator:a52f86665c1e1c3a34ef53095bf471308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bf79382f9c6599e04b48bf08e193270"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a4bf79382f9c6599e04b48bf08e193270">winnse_calc</a> (t9, rho, ye, yn, yp, imax, kit)</td></tr>
<tr class="memdesc:a4bf79382f9c6599e04b48bf08e193270"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the nse-equations.  <a href="namespacewinnse__module.html#a4bf79382f9c6599e04b48bf08e193270">More...</a><br /></td></tr>
<tr class="separator:a4bf79382f9c6599e04b48bf08e193270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72eefa0ccd8f0859c0019d2d18fad155"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a72eefa0ccd8f0859c0019d2d18fad155">winnse_calc_hybrid_powell</a> (t9, rho, ye, yn, yp, imax, kit)</td></tr>
<tr class="memdesc:a72eefa0ccd8f0859c0019d2d18fad155"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the nse-equations using the Powell hybrid method.  <a href="namespacewinnse__module.html#a72eefa0ccd8f0859c0019d2d18fad155">More...</a><br /></td></tr>
<tr class="separator:a72eefa0ccd8f0859c0019d2d18fad155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1789147c5a6bde2c78d2bdee255a44b8"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a1789147c5a6bde2c78d2bdee255a44b8">winnse_calc_nr</a> (t9, rho, ye, yn, yp, imax, kit)</td></tr>
<tr class="memdesc:a1789147c5a6bde2c78d2bdee255a44b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the nse-equations using a 2-dimensional newton-raphson scheme.  <a href="namespacewinnse__module.html#a1789147c5a6bde2c78d2bdee255a44b8">More...</a><br /></td></tr>
<tr class="separator:a1789147c5a6bde2c78d2bdee255a44b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51d55fb32259605b02d665c4bfb979b"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#ab51d55fb32259605b02d665c4bfb979b">nse_screen</a> (t9, rho, ye)</td></tr>
<tr class="memdesc:ab51d55fb32259605b02d665c4bfb979b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls screening subroutine and adds subsequent proton capture screening corrections in scrn(1:zmax).  <a href="namespacewinnse__module.html#ab51d55fb32259605b02d665c4bfb979b">More...</a><br /></td></tr>
<tr class="separator:ab51d55fb32259605b02d665c4bfb979b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f059289a0c97c6be525337bfd649af9"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a7f059289a0c97c6be525337bfd649af9">wincnse_calc</a> (t9, rho)</td></tr>
<tr class="memdesc:a7f059289a0c97c6be525337bfd649af9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the nse coefficients C, as given in <a href="https://ui.adsabs.harvard.edu/abs/1999JCoAM.109..321H/abstract">Hix,Thielemann '99</a>, Eq.25.  <a href="namespacewinnse__module.html#a7f059289a0c97c6be525337bfd649af9">More...</a><br /></td></tr>
<tr class="separator:a7f059289a0c97c6be525337bfd649af9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac8aed3c78ff055dbe8b79a57c7c0d85e"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#ac8aed3c78ff055dbe8b79a57c7c0d85e">ynse</a></td></tr>
<tr class="memdesc:ac8aed3c78ff055dbe8b79a57c7c0d85e"><td class="mdescLeft">&#160;</td><td class="mdescRight">NSE abundances.  <a href="namespacewinnse__module.html#ac8aed3c78ff055dbe8b79a57c7c0d85e">More...</a><br /></td></tr>
<tr class="separator:ac8aed3c78ff055dbe8b79a57c7c0d85e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b71f9d790527c525cc890d46b7f158"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#ad1b71f9d790527c525cc890d46b7f158">pf</a></td></tr>
<tr class="memdesc:ad1b71f9d790527c525cc890d46b7f158"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partition function for a given temperature.  <a href="namespacewinnse__module.html#ad1b71f9d790527c525cc890d46b7f158">More...</a><br /></td></tr>
<tr class="separator:ad1b71f9d790527c525cc890d46b7f158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e013b5a4d883a6bad790f77ae3b79a9"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a1e013b5a4d883a6bad790f77ae3b79a9">gg</a></td></tr>
<tr class="memdesc:a1e013b5a4d883a6bad790f77ae3b79a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">\( G(Z,A)=(2J_0+1) \) where \( J_0 \) is the spin of the ground state  <a href="namespacewinnse__module.html#a1e013b5a4d883a6bad790f77ae3b79a9">More...</a><br /></td></tr>
<tr class="separator:a1e013b5a4d883a6bad790f77ae3b79a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedfe001ac61e96881dd3972e862d5513"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#aedfe001ac61e96881dd3972e862d5513">be</a></td></tr>
<tr class="memdesc:aedfe001ac61e96881dd3972e862d5513"><td class="mdescLeft">&#160;</td><td class="mdescRight">Binding energy, calculated using mass excesses.  <a href="namespacewinnse__module.html#aedfe001ac61e96881dd3972e862d5513">More...</a><br /></td></tr>
<tr class="separator:aedfe001ac61e96881dd3972e862d5513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570bac71a06a3c850f9d560043f05f87"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a570bac71a06a3c850f9d560043f05f87">scrn</a></td></tr>
<tr class="memdesc:a570bac71a06a3c850f9d560043f05f87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Screening correction (details see <a class="el" href="namespacewinnse__module.html#ab51d55fb32259605b02d665c4bfb979b">nse_screen</a>)  <a href="namespacewinnse__module.html#a570bac71a06a3c850f9d560043f05f87">More...</a><br /></td></tr>
<tr class="separator:a570bac71a06a3c850f9d560043f05f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a932eb9a7c638ea9ecc65f66703c3a1a4"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a932eb9a7c638ea9ecc65f66703c3a1a4">cnse</a></td></tr>
<tr class="memdesc:a932eb9a7c638ea9ecc65f66703c3a1a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">NSE coefficients (details see cnsecalc)  <a href="namespacewinnse__module.html#a932eb9a7c638ea9ecc65f66703c3a1a4">More...</a><br /></td></tr>
<tr class="separator:a932eb9a7c638ea9ecc65f66703c3a1a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae698b5107f1a9b46182cb7d72a173cc7"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#ae698b5107f1a9b46182cb7d72a173cc7">ye_ext</a></td></tr>
<tr class="memdesc:ae698b5107f1a9b46182cb7d72a173cc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Electron fraction to pass to external function.  <a href="namespacewinnse__module.html#ae698b5107f1a9b46182cb7d72a173cc7">More...</a><br /></td></tr>
<tr class="separator:ae698b5107f1a9b46182cb7d72a173cc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc4643374e7a8dd96e00f139ab06fc4"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#aecc4643374e7a8dd96e00f139ab06fc4">aa</a></td></tr>
<tr class="memdesc:aecc4643374e7a8dd96e00f139ab06fc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mass number.  <a href="namespacewinnse__module.html#aecc4643374e7a8dd96e00f139ab06fc4">More...</a><br /></td></tr>
<tr class="separator:aecc4643374e7a8dd96e00f139ab06fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9589bbd740243ecf2a6b7a4976a983f0"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a9589bbd740243ecf2a6b7a4976a983f0">zz</a></td></tr>
<tr class="memdesc:a9589bbd740243ecf2a6b7a4976a983f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proton number.  <a href="namespacewinnse__module.html#a9589bbd740243ecf2a6b7a4976a983f0">More...</a><br /></td></tr>
<tr class="separator:a9589bbd740243ecf2a6b7a4976a983f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0fde7155a497990a93e46a69e745dcf"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#aa0fde7155a497990a93e46a69e745dcf">nn</a></td></tr>
<tr class="memdesc:aa0fde7155a497990a93e46a69e745dcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neutron number.  <a href="namespacewinnse__module.html#aa0fde7155a497990a93e46a69e745dcf">More...</a><br /></td></tr>
<tr class="separator:aa0fde7155a497990a93e46a69e745dcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fd8fd0d59ee767ebc9bcdb54b4d60e1"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewinnse__module.html#a9fd8fd0d59ee767ebc9bcdb54b4d60e1">zmax</a></td></tr>
<tr class="memdesc:a9fd8fd0d59ee767ebc9bcdb54b4d60e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Highest proton number occuring in network.  <a href="namespacewinnse__module.html#a9fd8fd0d59ee767ebc9bcdb54b4d60e1">More...</a><br /></td></tr>
<tr class="separator:a9fd8fd0d59ee767ebc9bcdb54b4d60e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module to calculate NSE. </p>
<p>The <a class="el" href="namespacewinnse__module.html" title="Module to calculate NSE.">winnse_module</a> calculates NSE composition (with or without screening corrections). For this it uses various inputs as, e.g., the partition functions, binding energies, and the spin of the ground state of each nucleus. The necessary data is stored in <a class="el" href="namespaceglobal__class.html#a85f694677af15353c1004701209a34ac">global_class::isotope</a>.</p>
<p>The NSE composition favors different nuclei, dependent on the conditions. A rough overview is given by: </p><div class="image">
<img src="nse_com.png" alt="" width="600"/>
<div class="caption">
Dominant nuclear species when assuming NSE for different conditions.</div></div>
<dl class="section see"><dt>See also</dt><dd><a href="https://ui.adsabs.harvard.edu/abs/1999JCoAM.109..321H/abstract">Hix &amp; Thielemann 1999</a>, <a href="https://edoc.unibas.ch/29895/">Winteler 2013</a>, <a href="https://ui.adsabs.harvard.edu/abs/2017ApJS..233...18L/abstract">Lippuner &amp; Roberts 2017</a>, <a href="https://ui.adsabs.harvard.edu/abs/2022arXiv221009965S/abstract">Smith et al. 2023</a> </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae51f5347267d3b4c302aebc38f248a23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae51f5347267d3b4c302aebc38f248a23">&#9670;&nbsp;</a></span>nse_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public winnse_module::nse_init</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates and initialises various arrays needed for the nse calculation. </p>
<p>This subroutine also writes the content of <a class="el" href="namespaceglobal__class.html#a85f694677af15353c1004701209a34ac">global_class::isotope</a> into shorter variables, such as <a class="el" href="namespacewinnse__module.html#aecc4643374e7a8dd96e00f139ab06fc4">aa</a>, <a class="el" href="namespacewinnse__module.html#aa0fde7155a497990a93e46a69e745dcf">nn</a>, and <a class="el" href="namespacewinnse__module.html#a1e013b5a4d883a6bad790f77ae3b79a9">gg</a>. In addition it calculates the binding energy </p><p class="formulaDsp">
\[ Be(i) = Z(i) \cdot Z_{me} + N(i) \cdot N_{me} - M_{exc}(i) \]
</p>
<p> with the mass excess of protons (Z) and neutrons (N), \( Z_{me} \) and \( N_{me} \), and the mass excess of the isotope \( M_{exc} \). Furthermore it calculates \( 1 + 2 \cdot J \) with J being the spin of the ground state.</p>
<p><b>Edited:</b> 12.01.14 </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00074">74</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="ab51d55fb32259605b02d665c4bfb979b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51d55fb32259605b02d665c4bfb979b">&#9670;&nbsp;</a></span>nse_screen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private winnse_module::nse_screen </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>t9</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ye</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calls screening subroutine and adds subsequent proton capture screening corrections in scrn(1:zmax). </p>
<p>This subroutine iterates over all possible amount of protons of a nucleus (up to <a class="el" href="namespacewinnse__module.html#a9fd8fd0d59ee767ebc9bcdb54b4d60e1">zmax</a>). It uses the subroutine screen to calculate the screening corrections. After it has been called, the array <a class="el" href="namespacewinnse__module.html#a570bac71a06a3c850f9d560043f05f87">scrn</a> contains summed screening corrections for proton captures from z=1 to z=i for scrn(i) on symmetric nuclei ( \( A = 2 \cdot Z \)).</p>
<p><b>Edited:</b> </p><ul>
<li>12.01.14</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t9</td><td>temperature in GK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>density in g/cm^3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>electron fraction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00584">584</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="a7f059289a0c97c6be525337bfd649af9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f059289a0c97c6be525337bfd649af9">&#9670;&nbsp;</a></span>wincnse_calc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private winnse_module::wincnse_calc </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>t9</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the nse coefficients C, as given in <a href="https://ui.adsabs.harvard.edu/abs/1999JCoAM.109..321H/abstract">Hix,Thielemann '99</a>, Eq.25. </p>
<p>This subroutine calculates: </p><p class="formulaDsp">
\[ \frac{G(^A Z)}{2^A} \left( \frac{ \rho N_A }{\theta} \right)^{A-1} A^{\frac{3}{2}} \exp{ \left( \frac{B(^A Z)}{k_B T} \right)} \]
</p>
<p> ,where \( G \) are the partition functions, A the mass number, \( \rho \) the density, \( N_A \) avogadros number, B the binding energy, \( k_B \) the boltzman constant, and T the temperature. Theta is a helper variable and given by: </p><p class="formulaDsp">
\[ \theta = \left( \frac{m_u k_B T}{2\pi \hbar^2} \right) \]
</p>
<p> The result is stored in the array <a class="el" href="namespacewinnse__module.html#a932eb9a7c638ea9ecc65f66703c3a1a4">cnse</a>.</p>
<p><b>Edited:</b> </p><ul>
<li>12.01.14</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t9</td><td>temperature in GK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>density in g/cm^3 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00626">626</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacewinnse__module_a7f059289a0c97c6be525337bfd649af9_cgraph.svg" width="394" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4bf79382f9c6599e04b48bf08e193270"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bf79382f9c6599e04b48bf08e193270">&#9670;&nbsp;</a></span>winnse_calc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private winnse_module::winnse_calc </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>t9</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ye</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>yn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>imax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>kit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solves the nse-equations. </p>
<p>This subroutine solves the NSE equations. It hereby choses between two different solvers as defined by the parameter <a class="el" href="namespaceparameter__class.html#a56e27d4aff525697f0e27b982c3a4c55">parameter_class::nse_solver</a> that is defined as in the following table: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">nse_solver </th><th class="markdownTableHeadCenter">Solver  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0 </td><td class="markdownTableBodyCenter">Newton-Raphson  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">1 </td><td class="markdownTableBodyCenter">Powell's hybrid method  </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>14.06.23 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t9</td><td>temperature in GK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>density in g/cm^3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>electron fraction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yn</td><td>neutron abundance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yp</td><td>proton abundance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imax</td><td>max. number of iterations </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kit</td><td>actual number of iterations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00274">274</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacewinnse__module_a4bf79382f9c6599e04b48bf08e193270_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a72eefa0ccd8f0859c0019d2d18fad155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72eefa0ccd8f0859c0019d2d18fad155">&#9670;&nbsp;</a></span>winnse_calc_hybrid_powell()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private winnse_module::winnse_calc_hybrid_powell </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>t9</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ye</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>yn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>imax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>kit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solves the nse-equations using the Powell hybrid method. </p>
<p>This subroutine solves the NSE equations. It's two dimensional as the unknowns are the neutron abundances Yn and proton abundances Yp. The underlying constraints are mass conservation \( \sum X_i = \sum Y_i \cdot A_i = 1 \) and charge conservation \( \sum Y_i \cdot Z_i = y_e \). The subroutine makes use of the minpack routine fsolve.</p>
<dl class="section author"><dt>Author</dt><dd>M. Reichert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>14.06.23 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t9</td><td>temperature in GK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>density in g/cm^3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>electron fraction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yn</td><td>neutron abundance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yp</td><td>proton abundance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imax</td><td>max. number of iterations </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kit</td><td>actual number of iterations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00322">322</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacewinnse__module_a72eefa0ccd8f0859c0019d2d18fad155_cgraph.svg" width="100%" height="556"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a1789147c5a6bde2c78d2bdee255a44b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1789147c5a6bde2c78d2bdee255a44b8">&#9670;&nbsp;</a></span>winnse_calc_nr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private winnse_module::winnse_calc_nr </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>t9</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ye</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>yn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>imax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>kit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solves the nse-equations using a 2-dimensional newton-raphson scheme. </p>
<p>This subroutine solves the NSE equations. It's two dimensional as the unknowns are the neutron abundances Yn and proton abundances Yp. The underlying constraints are mass conservation \( \sum X_i = \sum Y_i \cdot A_i = 1 \) and charge conservation \( \sum Y_i \cdot Z_i = y_e \). Furthermore it uses the so called saha equation: </p><p class="formulaDsp">
\[ Y(N,Z) = G_{N,Z}(\rho N_A)^{N+Z-1}\frac{\left( N +Z \right)^{3/2}}{2^{N+Z}}\left(\frac{2\pi \hbar} {m_\mathrm{u} k_{\mathrm{B}}T}\right)^{\frac{3}{2}(N+Z-1)} \mathrm{exp}(B_{N,Z}/ k_B T)Y^{N}_\mathrm{n} Y^Z_\mathrm{p}, \]
</p>
<dl class="section warning"><dt>Warning</dt><dd>Here, the abundance of neutrons and protons are used explicitely. A simulation without neutrons and protons specified in the sunet that tries to calculate NSE will result in an error!</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacewinnse__module.html#a7f059289a0c97c6be525337bfd649af9" title="Calculates the nse coefficients C, as given in Hix,Thielemann &#39;99, Eq.25.">wincnse_calc</a></dd></dl>
<p><b>Edited:</b> </p><ul>
<li>12.01.14</li>
<li>15.01.21</li>
<li>23.01.21 MR, Fixed overflows in this routine</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t9</td><td>temperature in GK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>density in g/cm^3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>electron fraction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yn</td><td>neutron abundance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yp</td><td>proton abundance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imax</td><td>max. number of iterations </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kit</td><td>actual number of iterations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00400">400</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacewinnse__module_a1789147c5a6bde2c78d2bdee255a44b8_cgraph.svg" width="602" height="274"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a52f86665c1e1c3a34ef53095bf471308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52f86665c1e1c3a34ef53095bf471308">&#9670;&nbsp;</a></span>winnse_descend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public winnse_module::winnse_descend </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>t9strt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>t9fnl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ye</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>yni</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ypi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(net_size), intent(inout)&#160;</td>
          <td class="paramname"><em>ysol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This routine descends from an initially high temperature, at which the NSE abudances can be accurately predicted, to the desired temperature. </p>
<p>At high temperatures, the solution is more stable and the solution of NSE at a high temperature can be used as an initial guess of a lower temperature. This increases the stability of the calculation and it can iterate to the input temperature "t9fnl". The temperature step is adaptive in this process, however, if it becomes too small ( \( 10^{-20} \) GK) an error is raised. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t9strt</td><td>high initial temperature in GK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t9fnl</td><td>desired temperature in GK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>density in g/cm^3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>electron fraction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yni</td><td>neutron abundance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ypi</td><td>proton abundance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ysol</td><td>[out] nse abundances </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00176">176</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacewinnse__module_a52f86665c1e1c3a34ef53095bf471308_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a6c116c4da1815117e3dd1ae3ad23fcb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c116c4da1815117e3dd1ae3ad23fcb1">&#9670;&nbsp;</a></span>winnse_guess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public winnse_module::winnse_guess </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>t9</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ye</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>yn_guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>yp_guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(net_size), intent(inout)&#160;</td>
          <td class="paramname"><em>ysol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate NSE composition with an initial guess. </p>
<p>The subroutine tries to calculate nse with an initial guess and if it does not converge, it descends from a high temperature. This routine is used if the parameter <a class="el" href="namespaceparameter__class.html#ac48a19a268b35aca6e2a4b912a04857b">parameter_class::nse_calc_every</a> is not equal to zero.</p>
<dl class="section author"><dt>Author</dt><dd>Moritz Reichert </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t9</td><td>desired temperature in GK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>density in g/cm^3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>electron fraction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yn_guess</td><td>neutron abundance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yp_guess</td><td>proton abundance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ysol</td><td>[out] nse abundances </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00115">115</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacewinnse__module_a6c116c4da1815117e3dd1ae3ad23fcb1_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aecc4643374e7a8dd96e00f139ab06fc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc4643374e7a8dd96e00f139ab06fc4">&#9670;&nbsp;</a></span>aa</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable, public winnse_module::aa</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mass number. </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00045">45</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="aedfe001ac61e96881dd3972e862d5513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedfe001ac61e96881dd3972e862d5513">&#9670;&nbsp;</a></span>be</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, private winnse_module::be</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Binding energy, calculated using mass excesses. </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00040">40</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="a932eb9a7c638ea9ecc65f66703c3a1a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a932eb9a7c638ea9ecc65f66703c3a1a4">&#9670;&nbsp;</a></span>cnse</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, public winnse_module::cnse</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>NSE coefficients (details see cnsecalc) </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00042">42</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="a1e013b5a4d883a6bad790f77ae3b79a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e013b5a4d883a6bad790f77ae3b79a9">&#9670;&nbsp;</a></span>gg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, private winnse_module::gg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>\( G(Z,A)=(2J_0+1) \) where \( J_0 \) is the spin of the ground state </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00039">39</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="aa0fde7155a497990a93e46a69e745dcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0fde7155a497990a93e46a69e745dcf">&#9670;&nbsp;</a></span>nn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable, public winnse_module::nn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Neutron number. </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00047">47</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="ad1b71f9d790527c525cc890d46b7f158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1b71f9d790527c525cc890d46b7f158">&#9670;&nbsp;</a></span>pf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, public winnse_module::pf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Partition function for a given temperature. </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00038">38</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="a570bac71a06a3c850f9d560043f05f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570bac71a06a3c850f9d560043f05f87">&#9670;&nbsp;</a></span>scrn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, private winnse_module::scrn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Screening correction (details see <a class="el" href="namespacewinnse__module.html#ab51d55fb32259605b02d665c4bfb979b">nse_screen</a>) </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00041">41</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="ae698b5107f1a9b46182cb7d72a173cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae698b5107f1a9b46182cb7d72a173cc7">&#9670;&nbsp;</a></span>ye_ext</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), public winnse_module::ye_ext</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Electron fraction to pass to external function. </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00043">43</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="ac8aed3c78ff055dbe8b79a57c7c0d85e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8aed3c78ff055dbe8b79a57c7c0d85e">&#9670;&nbsp;</a></span>ynse</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="macros_8h.html#a3e504da5bba4b12ec3e39594fa54d992">r_kind</a>), dimension(:), allocatable, public winnse_module::ynse</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>NSE abundances. </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00037">37</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="a9fd8fd0d59ee767ebc9bcdb54b4d60e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fd8fd0d59ee767ebc9bcdb54b4d60e1">&#9670;&nbsp;</a></span>zmax</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private winnse_module::zmax</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Highest proton number occuring in network. </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00049">49</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
<a id="a9589bbd740243ecf2a6b7a4976a983f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9589bbd740243ecf2a6b7a4976a983f0">&#9670;&nbsp;</a></span>zz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable, public winnse_module::zz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Proton number. </p>

<p class="definition">Definition at line <a class="el" href="winnse__module_8f90_source.html#l00046">46</a> of file <a class="el" href="winnse__module_8f90_source.html">winnse_module.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacewinnse__module.html">winnse_module</a></li>
  </ul>
</div>
</body>
</html>
